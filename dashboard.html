<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EduPro - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="bg-gray-50 text-gray-800 font-sans flex flex-col min-h-screen">
    <nav class="bg-white shadow-md fixed w-full z-50 top-0 left-0">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between h-16">
          <div class="flex items-center">
            <a href="index.html" class="text-2xl font-bold text-blue-600"
              ><i class="fas fa-graduation-cap"></i> EduPro</a
            >
          </div>
          <div class="hidden md:flex items-center space-x-8">
            <a href="index.html" class="text-gray-600 hover:text-blue-600"
              >Home</a
            >
            <a href="courses.html" class="text-gray-600 hover:text-blue-600"
              >Courses</a
            >
            <a href="dashboard.html" class="text-blue-600 font-semibold"
              >Dashboard</a
            >
          </div>
          <div class="md:hidden flex items-center">
            <button
              id="mobile-menu-btn"
              class="text-gray-600 hover:text-blue-600 focus:outline-none"
            >
              <i class="fas fa-bars text-2xl"></i>
            </button>
          </div>
        </div>
      </div>
      <div
        id="mobile-menu"
        class="hidden md:hidden bg-white pb-4 px-4 border-t"
      >
        <a href="index.html" class="block py-2 text-gray-600">Home</a>
        <a href="courses.html" class="block py-2 text-gray-600">Courses</a>
        <a href="dashboard.html" class="block py-2 text-blue-600 font-bold"
          >Dashboard</a
        >
      </div>
    </nav>

    <div id="dashboard-header" class="pt-24 pb-12 max-w-7xl mx-auto px-4">
      <div class="flex items-center gap-4 mb-2">
        <div
          class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold text-xl"
          id="user-initial"
        >
          S
        </div>
        <div>
          <h1 class="text-2xl font-bold">My Dashboard</h1>
          <p class="text-gray-500 text-sm" id="user-welcome">
            Welcome back, Student
          </p>
        </div>
      </div>
    </div>

    <div id="dashboard-content" class="max-w-7xl mx-auto px-4 flex-grow">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10 mt-8">
        <div
          class="bg-gradient-to-br from-blue-500 to-blue-600 text-white p-6 rounded-xl shadow-lg"
        >
          <div class="flex justify-between items-center">
            <h3 class="text-blue-100 font-medium">Courses Enrolled</h3>
            <i class="fas fa-book opacity-50 text-2xl"></i>
          </div>
          <p class="text-4xl font-bold mt-2" id="total-enrolled">0</p>
        </div>
        <div
          class="bg-gradient-to-br from-green-500 to-green-600 text-white p-6 rounded-xl shadow-lg"
        >
          <div class="flex justify-between items-center">
            <h3 class="text-green-100 font-medium">Quizzes Passed</h3>
            <i class="fas fa-certificate opacity-50 text-2xl"></i>
          </div>
          <p class="text-4xl font-bold mt-2" id="total-certs">0</p>
        </div>
        <div
          class="bg-white p-6 rounded-xl shadow border border-gray-100 flex items-center justify-center"
          id="next-goal-card"
        >
          <div class="text-center">
            <p class="text-gray-500 mb-2">Next Goal</p>
            <a
              href="courses.html"
              class="text-blue-600 font-bold hover:underline"
              >Find a new course &rarr;</a
            >
          </div>
        </div>
      </div>

      <h2 class="text-xl font-bold mb-6 border-b pb-2">My Progress</h2>
      <div id="enrolled-grid" class="grid grid-cols-1 gap-4"></div>

      <!-- CERTIFICATES SECTION -->
      <h2 class="text-xl font-bold my-6 border-b pb-2">Certificates</h2>

      <div
        id="certificates-grid"
        class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8"
      >
        <!-- Filled dynamically -->
      </div>

      <!-- Quick verify -->
      <div class="bg-white p-6 rounded-lg shadow-md mb-16">
        <h3 class="text-lg font-bold mb-2">Verify a Certificate</h3>
        <p class="text-sm text-gray-600 mb-4">
          Paste a Certificate ID to verify ownership and details.
        </p>
        <div class="flex gap-3">
          <input
            id="verify-input"
            class="border rounded px-4 py-2 flex-1"
            placeholder="Certificate ID (e.g. 1-k4j3l...)"
          />
          <button
            id="verify-btn"
            class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700"
          >
            Verify
          </button>
        </div>
        <div id="verify-result" class="mt-4 text-sm"></div>
      </div>
    </div>

    <footer class="bg-gray-800 text-white py-8 text-center mt-auto">
      <p>&copy; 2025 EduPro LMS. All rights reserved.</p>
    </footer>

    <!-- ======= courses-json-loader (keeps previous pattern) ======= -->
    <script>
      (function () {
        try {
          if (!localStorage.getItem("lmsCourses")) {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "courses.json", false); // synchronous small project loader
            xhr.send(null);
            if (xhr.status >= 200 && xhr.status < 300) {
              localStorage.setItem("lmsCourses", xhr.responseText);
            } else {
              console.warn("courses.json load failed, status:", xhr.status);
            }
          }
        } catch (e) {
          console.error("Synchronous load of courses.json failed:", e);
        }

        try {
          window.coursesData = JSON.parse(
            localStorage.getItem("lmsCourses") || "[]"
          );
        } catch (e) {
          console.error("Failed to parse lmsCourses from localStorage:", e);
          window.coursesData = [];
        }
      })();
    </script>
    <!-- ================================================================ -->
    <script src="script.js"></script>

    <script>
      // Wait for DOM + script.js to be available
      document.addEventListener("DOMContentLoaded", () => {
        // helpers
        function htmlToElement(html) {
          const div = document.createElement("div");
          div.innerHTML = html.trim();
          return div.firstElementChild;
        }

        const currentUser =
          typeof getCurrentUser === "function" ? getCurrentUser() : null;
        const header = document.getElementById("dashboard-header");
        const content = document.getElementById("dashboard-content");

        if (!currentUser) {
          // Not logged in -> show access denied
          if (header) header.innerHTML = "";
          if (content) {
            content.innerHTML = `
              <div class="bg-white p-12 rounded-xl shadow-lg text-center my-10">
                <i class="fas fa-lock text-6xl text-red-500 mb-4"></i>
                <h2 class="text-3xl font-bold mb-2 text-gray-800">Access Denied</h2>
                <p class="text-lg mb-6 text-gray-600">Please log in to view your personalized dashboard and course progress.</p>
                <a href="login.html" class="bg-blue-600 text-white px-8 py-3 rounded-lg font-bold hover:bg-blue-700 transition shadow-md">
                  <i class="fas fa-sign-in-alt mr-2"></i> Go to Login
                </a>
              </div>
            `;
          }
          return;
        }

        // Logged in - render the dashboard for this user only
        const userName = currentUser.name || "Student";
        const initialEl = document.getElementById("user-initial");
        const welcomeEl = document.getElementById("user-welcome");
        if (initialEl) initialEl.innerText = userName.charAt(0).toUpperCase();
        if (welcomeEl) welcomeEl.innerText = `Welcome back, ${userName}`;

        // small init function to render user-specific content
        function initDashboard() {
          const userProgress =
            typeof getProgressDataForUser === "function"
              ? getProgressDataForUser()
              : {};
          const enrolledIds =
            typeof getEnrolledCourseIdsForUser === "function"
              ? getEnrolledCourseIdsForUser()
              : Object.keys(userProgress);

          const container = document.getElementById("enrolled-grid");
          const nextGoalCard = document.getElementById("next-goal-card");
          const totalEnrolledEl = document.getElementById("total-enrolled");
          const totalCertsEl = document.getElementById("total-certs");

          const certContainer = document.getElementById("certificates-grid");
          const verifyBtn = document.getElementById("verify-btn");
          const verifyInput = document.getElementById("verify-input");
          const verifyResult = document.getElementById("verify-result");

          if (totalEnrolledEl) totalEnrolledEl.innerText = enrolledIds.length;

          // Render enrolled grid
          if (!container) return;
          container.innerHTML = "";

          if (enrolledIds.length === 0) {
            container.innerHTML = `
              <div class="text-center py-10 bg-white rounded-lg border border-dashed border-gray-300">
                <p class="text-gray-500 mb-4">You haven't started any courses yet, ${userName}.</p>
                <a href="courses.html" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700">Browse Courses</a>
              </div>
            `;
            if (totalCertsEl) totalCertsEl.innerText = 0;
          } else {
            // Build each enrolled card
            const incompleteCourses = [];
            let certificatesCount = 0;

            enrolledIds.forEach((id) => {
              const courseId = parseInt(id, 10);
              if (!courseId) return;
              const course = (window.coursesData || []).find(
                (c) => c.id === courseId
              );
              if (!course) return;

              const pData = userProgress[id] || {
                completedLessons: [],
                quizScore: null,
              };
              const totalLessons = (course.lessons || []).length;
              const hasQuiz =
                Array.isArray(course.quiz) && course.quiz.length > 0;
              const totalUnits = totalLessons + (hasQuiz ? 1 : 0);

              const completedLessonsCount = Array.isArray(
                pData.completedLessons
              )
                ? pData.completedLessons.length
                : 0;
              const quizCompleted =
                pData.quizScore !== null && pData.quizScore !== undefined;
              const completedUnits =
                completedLessonsCount + (hasQuiz && quizCompleted ? 1 : 0);

              const percent =
                totalUnits === 0
                  ? 0
                  : Math.min(
                      100,
                      Math.floor((completedUnits / totalUnits) * 100)
                    );
              const passed =
                pData.quizScore !== null && pData.quizScore >= PASS_SCORE;

              if (passed) certificatesCount++;
              else if (percent < 100)
                incompleteCourses.push({
                  title: course.title,
                  id: course.id,
                  percent,
                });

              const lastId = pData.lastVisited || null;
              const lastLessonTitle =
                lastId && course.lessons.find((l) => l.id === lastId)
                  ? course.lessons.find((l) => l.id === lastId).title
                  : null;
              const lastTextHtml = lastLessonTitle
                ? `<a href="lesson.html?courseId=${courseId}&lessonId=${lastId}" class="hover:underline text-blue-600">Last: ${escapeHtml(
                    lastLessonTitle
                  )}</a>`
                : "Not started";

              const quizStatusHtml =
                pData.quizScore !== null && pData.quizScore !== undefined
                  ? `<span class="font-bold ${
                      passed ? "text-green-600" : "text-red-500"
                    }">Quiz Score: ${pData.quizScore}/${
                      (course.quiz || []).length
                    } ${passed ? "(Passed)" : "(Failed)"}</span>`
                  : percent === 100 && hasQuiz
                  ? `<span class="font-bold text-orange-500">Quiz Pending!</span>`
                  : `<span class="text-gray-500">Quiz Pending</span>`;

              const cardHtml = `
                <div class="bg-white border rounded-lg p-6 flex flex-col md:flex-row items-center gap-6 shadow-sm hover:shadow-md transition">
                  <img src="${
                    course.image || ""
                  }" class="w-full md:w-32 h-32 md:h-20 rounded object-cover" alt="${escapeHtml(
                course.title
              )}">
                  <div class="flex-1 w-full">
                    <h3 class="text-lg font-bold text-gray-800">${escapeHtml(
                      course.title
                    )}</h3>
                    <p class="text-sm text-gray-500 mt-1">${lastTextHtml}</p>
                    <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2 mb-1">
                      <div class="bg-blue-600 h-2.5 rounded-full" style="width: ${percent}%"></div>
                    </div>
                    <div class="flex justify-between text-sm text-gray-600 mt-2">
                      <span>${percent}% Complete</span>
                      ${quizStatusHtml}
                    </div>
                  </div>
                  <a href="course-detail.html?id=${
                    course.id
                  }" class="w-full md:w-auto text-center px-6 py-2 border border-blue-600 text-blue-600 rounded hover:bg-blue-50 transition">
                    ${percent === 100 ? "Review" : "Continue"}
                  </a>
                </div>
              `;
              container.insertAdjacentHTML("beforeend", cardHtml);
            });

            if (totalCertsEl) totalCertsEl.innerText = certificatesCount;

            // Next goal card
            if (incompleteCourses.length > 0) {
              incompleteCourses.sort((a, b) => a.percent - b.percent);
              const nextCourse = incompleteCourses[0];
              if (nextGoalCard) {
                nextGoalCard.innerHTML = `
                  <div class="text-center">
                    <p class="text-gray-500 mb-2">Next Step: <strong>${escapeHtml(
                      nextCourse.title
                    )}</strong></p>
                    <a href="course-detail.html?id=${
                      nextCourse.id
                    }" class="text-blue-600 font-bold hover:underline">
                      Continue at ${nextCourse.percent}% &rarr;
                    </a>
                  </div>
                `;
              }
            } else if (
              certificatesCount > 0 &&
              certificatesCount === enrolledIds.length &&
              enrolledIds.length > 0
            ) {
              if (nextGoalCard) {
                nextGoalCard.innerHTML = `
                  <div class="text-center">
                    <p class="text-green-600 mb-2 font-bold">All Courses Completed! ðŸ¥³</p>
                    <a href="courses.html" class="text-blue-600 font-bold hover:underline">Explore Advanced Courses &rarr;</a>
                  </div>
                `;
              }
            } else {
              if (nextGoalCard) {
                nextGoalCard.innerHTML = `
                  <div class="text-center">
                    <p class="text-gray-500 mb-2">Next Goal</p>
                    <a href="courses.html" class="text-blue-600 font-bold hover:underline">Find a new course &rarr;</a>
                  </div>
                `;
              }
            }
          }

          // Certificates rendering using centralized helper
          if (!certContainer) return;
          certContainer.innerHTML = "";
          const certs =
            typeof listCertificatesForUser === "function"
              ? listCertificatesForUser()
              : [];

          if (!certs || certs.length === 0) {
            certContainer.innerHTML = `
              <div class="col-span-1 md:col-span-3 bg-white p-6 rounded-lg border border-dashed border-gray-300 text-center text-gray-500">
                <p class="mb-3">You have no certificates yet.</p>
                <a href="courses.html" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Browse Courses</a>
              </div>
            `;
            if (totalCertsEl) totalCertsEl.innerText = 0;
          } else {
            if (totalCertsEl) totalCertsEl.innerText = certs.length;
            certs.forEach((cert) => {
              const issuedDate = new Date(cert.issuedOn).toLocaleDateString();
              const safeId = cert.id.replace(/["'<>]/g, ""); // keep simple safety for attribute insertion
              const cardHtml = `
                <div class="bg-white p-4 rounded-lg shadow-sm flex flex-col justify-between">
                  <div>
                    <h3 class="font-bold text-gray-800">${escapeHtml(
                      cert.courseTitle || ""
                    )}</h3>
                    <p class="text-sm text-gray-500 mt-1">Issued: <strong>${issuedDate}</strong></p>
                    <p class="text-sm text-gray-500 mt-1">Score: <strong>${escapeHtml(
                      String(cert.score)
                    )}</strong></p>
                    <p class="text-xs text-gray-400 mt-3 break-words">Certificate ID: <span class="font-mono" data-cert-id="${safeId}">${escapeHtml(
                cert.id
              )}</span></p>
                  </div>
                  <div class="mt-4 flex gap-2">
                    <button data-course-id="${
                      cert.courseId
                    }" data-cert-id="${safeId}" class="cert-download-btn flex-1 bg-blue-600 text-white px-3 py-2 rounded hover:bg-blue-700 text-sm"><i class="fas fa-download mr-2"></i>Download PDF</button>
                    <button data-course-id="${
                      cert.courseId
                    }" data-cert-id="${safeId}" class="cert-print-btn bg-gray-800 text-white px-3 py-2 rounded hover:bg-gray-900 text-sm"><i class="fas fa-print mr-2"></i>Print</button>
                    <button data-cert-id="${safeId}" class="cert-view-btn bg-indigo-600 text-white px-3 py-2 rounded hover:bg-indigo-700 text-sm"><i class="fas fa-eye mr-2"></i>View</button>
                    <button data-cert-id="${safeId}" class="cert-copy-btn bg-white border border-gray-200 px-3 py-2 rounded hover:bg-gray-50 text-sm"><i class="fas fa-clipboard mr-1"></i></button>
                  </div>
                </div>
              `;
              certContainer.insertAdjacentHTML("beforeend", cardHtml);
            });

            // Wire certificate buttons (delegated)
            certContainer
              .querySelectorAll(".cert-download-btn")
              .forEach((btn) => {
                btn.addEventListener("click", (e) => {
                  const courseId = Number(btn.dataset.courseId);
                  if (typeof downloadCertificatePDF === "function") {
                    downloadCertificatePDF(courseId);
                  } else {
                    alert("Download not available.");
                  }
                });
              });
            certContainer.querySelectorAll(".cert-print-btn").forEach((btn) => {
              btn.addEventListener("click", () => {
                const courseId = Number(btn.dataset.courseId);
                if (typeof printCertificate === "function") {
                  printCertificate(courseId);
                } else {
                  window.print();
                }
              });
            });
            certContainer.querySelectorAll(".cert-view-btn").forEach((btn) => {
              btn.addEventListener("click", () => {
                const certId = btn.dataset.certId;
                openCertPreview(certId);
              });
            });
            certContainer.querySelectorAll(".cert-copy-btn").forEach((btn) => {
              btn.addEventListener("click", () => {
                const certId = btn.dataset.certId;
                copyCertId(certId);
              });
            });
          }

          // VERIFY button wiring (uses centralized verifyCertificate)
          if (verifyBtn && verifyInput && verifyResult) {
            verifyBtn.addEventListener("click", () => {
              const id = (verifyInput.value || "").trim();
              if (!id) {
                verifyResult.innerHTML = `<span class="text-red-500">Please enter a certificate ID.</span>`;
                return;
              }
              // Prefer centralized verifyCertificate helper
              const res =
                typeof verifyCertificate === "function"
                  ? verifyCertificate(id)
                  : null;
              if (!res || !res.valid) {
                verifyResult.innerHTML = `<div class="text-red-600 font-bold">Certificate not found or invalid.</div>`;
              } else {
                verifyResult.innerHTML = `
                  <div class="text-green-600 font-bold">Valid Certificate</div>
                  <div class="text-sm text-gray-700 mt-2">Course: <strong>${escapeHtml(
                    res.certificate.courseTitle
                  )}</strong></div>
                  <div class="text-sm text-gray-700">Student: <strong>${escapeHtml(
                    res.studentName
                  )}</strong></div>
                  <div class="text-sm text-gray-700">Issued: <strong>${new Date(
                    res.certificate.issuedOn
                  ).toLocaleDateString()}</strong></div>
                  <div class="text-sm text-gray-700">Score: <strong>${escapeHtml(
                    String(res.certificate.score)
                  )}</strong></div>
                `;
              }
            });
          }
        } // end initDashboard

        // small utilities used by the dashboard (safe, centralized)
        function copyCertId(id) {
          if (!id) return;
          const text = id;
          if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(text).then(
              () => alert("Certificate ID copied to clipboard."),
              () => fallbackCopy(text)
            );
          } else {
            fallbackCopy(text);
          }
        }
        function fallbackCopy(text) {
          // fallback using temporary textarea
          const ta = document.createElement("textarea");
          ta.value = text;
          ta.style.position = "fixed";
          ta.style.left = "-9999px";
          document.body.appendChild(ta);
          ta.select();
          try {
            document.execCommand("copy");
            alert("Certificate ID copied to clipboard.");
          } catch (e) {
            prompt("Copy this certificate ID:", text);
          }
          ta.remove();
        }

        function openCertPreview(certId) {
          if (!certId) {
            alert("Certificate ID missing.");
            return;
          }
          // use centralized finder
          const found =
            typeof findCertificateById === "function"
              ? findCertificateById(certId)
              : null;
          if (!found || !found.valid) {
            alert("Certificate not found.");
            return;
          }

          // populate modal (existing markup present at bottom of page)
          const modal = document.getElementById("cert-preview-modal");
          if (!modal) {
            alert("Preview modal not found.");
            return;
          }

          const cpCourse = document.getElementById("cp-course");
          const cpIssued = document.getElementById("cp-issued");
          const cpScore = document.getElementById("cp-score");
          const cpId = document.getElementById("cp-id");
          const cpVerifyResult = document.getElementById("cp-verify-result");
          const downloadBtn = document.getElementById("cp-download-btn");
          const printBtn = document.getElementById("cp-print-btn");
          const verifyBtnModal = document.getElementById("cp-verify-btn");

          if (cpCourse) cpCourse.innerText = found.cert.courseTitle || "";
          if (cpIssued)
            cpIssued.innerText = new Date(
              found.cert.issuedOn
            ).toLocaleDateString();
          if (cpScore) cpScore.innerText = `${found.cert.score}`;
          if (cpId) cpId.innerText = found.cert.id;
          if (cpVerifyResult) cpVerifyResult.innerHTML = "";

          if (downloadBtn) {
            downloadBtn.onclick = () => {
              if (typeof downloadCertificatePDF === "function")
                downloadCertificatePDF(found.cert.courseId);
            };
          }
          if (printBtn) {
            printBtn.onclick = () => {
              if (typeof printCertificate === "function")
                printCertificate(found.cert.courseId);
            };
          }
          if (verifyBtnModal) {
            verifyBtnModal.onclick = () => {
              // re-verify using centralized method
              const r =
                typeof verifyCertificate === "function"
                  ? verifyCertificate(found.cert.id)
                  : null;
              if (!r || !r.valid) {
                if (cpVerifyResult)
                  cpVerifyResult.innerHTML = `<span class="text-red-600">Not verified</span>`;
              } else {
                if (cpVerifyResult)
                  cpVerifyResult.innerHTML = `<span class="text-green-600 font-bold">Verified</span><div class="text-sm text-gray-700 mt-2">Student: <strong>${escapeHtml(
                    r.studentName
                  )}</strong><br/>Issued: <strong>${new Date(
                    r.certificate.issuedOn
                  ).toLocaleDateString()}</strong></div>`;
              }
            };
          }

          // show modal
          modal.classList.remove("hidden");
          modal.classList.add("flex");
        }

        // close preview handlers
        const cpCloseBtn = document.getElementById("cp-close-btn");
        if (cpCloseBtn) {
          cpCloseBtn.addEventListener("click", () => {
            const modal = document.getElementById("cert-preview-modal");
            if (modal) {
              modal.classList.add("hidden");
              modal.classList.remove("flex");
              const area = document.getElementById("cp-verify-result");
              if (area) area.innerHTML = "";
            }
          });
        }
        const cpCopyBtn = document.getElementById("cp-copy-id-btn");
        if (cpCopyBtn) {
          cpCopyBtn.addEventListener("click", () => {
            const idNode = document.getElementById("cp-id");
            if (idNode) copyCertId(idNode.innerText || "");
          });
        }

        // Kick off initial render
        initDashboard();

        // Mobile menu toggle (kept)
        const mmBtn = document.getElementById("mobile-menu-btn");
        const mm = document.getElementById("mobile-menu");
        if (mmBtn && mm) {
          mmBtn.addEventListener("click", () => mm.classList.toggle("hidden"));
        }
      });

      // simple escape helper used above
      function escapeHtml(str) {
        if (typeof str !== "string") return str;
        return str
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;")
          .replace(/"/g, "&quot;")
          .replace(/'/g, "&#039;");
      }
    </script>

    <!-- Certificate Preview Modal -->
    <div
      id="cert-preview-modal"
      class="fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center p-4 z-[100]"
    >
      <div class="bg-white rounded-lg w-full max-w-3xl p-6 relative">
        <button
          id="cp-close-btn"
          class="absolute top-4 right-4 text-gray-500 hover:text-gray-900"
        >
          <i class="fas fa-times"></i>
        </button>
        <h3 class="text-2xl font-bold mb-2">Certificate Preview</h3>
        <div class="border rounded p-6">
          <p class="text-sm text-gray-500">Course</p>
          <h2 id="cp-course" class="text-xl font-bold mb-2"></h2>
          <div class="flex gap-6 text-sm text-gray-700">
            <div>Issued: <strong id="cp-issued"></strong></div>
            <div>Score: <strong id="cp-score"></strong></div>
            <div>
              Certificate ID: <strong id="cp-id" class="font-mono"></strong>
            </div>
          </div>
          <div id="cp-verify-result" class="mt-4"></div>
        </div>

        <div class="mt-4 flex gap-3">
          <button
            id="cp-download-btn"
            class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
          >
            <i class="fas fa-download mr-2"></i>Download PDF
          </button>
          <button
            id="cp-print-btn"
            class="bg-gray-800 text-white px-4 py-2 rounded hover:bg-gray-900"
          >
            <i class="fas fa-print mr-2"></i>Print
          </button>
          <button
            id="cp-verify-btn"
            class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"
          >
            <i class="fas fa-check mr-2"></i>Verify
          </button>
          <button
            id="cp-copy-id-btn"
            class="bg-white border px-4 py-2 rounded hover:bg-gray-50"
          >
            <i class="fas fa-clipboard mr-2"></i>Copy ID
          </button>
        </div>
      </div>
    </div>
  </body>
</html>
